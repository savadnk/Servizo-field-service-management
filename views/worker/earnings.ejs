<style>
  :root{
    --bg:#000000; --panel:#151821; --row:#1a1d24; --muted:#9aa3b2; --line:#232735;
    --chip:#222733; --chipText:#d8deea; --green:#22c55e; --blue:#3b82f6; --card:#151821;
    --amber:#f59e0b; --cyan:#22d3ee; --danger:#ef4444; --txt:#e8ecf4; --grey:#4b5563;
    --text-100:#e8f1ee; --text-300:#a7b0ad; --muted-600:#4d4f55; --muted-500:#5a5c62;
    --brand-500:#16da64; --brand-600:#12b754; --chip-border:#284430; --surface:#111418;
  }

  body{ background: var(--bg); color: var(--txt); }



  /* Summary cards */
  .summary-card{
    border-radius: 14px;
    padding: 14px;
    color: var(--text-100);
    border: 1px solid var(--line);
  }
  .summary-green{ background: #0f2a1b; } /* dark green panel */
  .summary-blue { background: #101a2a; } /* dark blue panel */

  .summary-value{  font-weight: 800; line-height: 1; }

  /* Payment table */
  .table-wrap{
    
    background: var(--panel);
    border: 1px solid var(--line);
    border-radius: 14px;

  }
  table{ width:100%; border-collapse: collapse; }
  thead th{
    background: var(--row);
    color: var(--text-100);
    padding: 12px 10px;
    text-align: left;
    border-bottom: 1px solid var(--line);
    white-space: nowrap;
    position: sticky;
    top: 0;
    z-index: 2;
  }
  tbody td{
    padding: 12px 10px;
    border-bottom: 1px solid var(--line);
    color: var(--txt);
    vertical-align: middle;
  }
  tbody tr:nth-child(odd){ background: #131822; }
  tbody tr:nth-child(even){ background: #10151f; }

  .badge-pill{
    display:inline-block; padding:6px 10px; border-radius:999px;
    font-weight:700; font-size:12px; border:1px solid transparent;
  }
  .table-responsive{
    max-height: 500px;
        overflow-y: auto;
    display: block;
  }

  .table-responsive::-webkit-scrollbar {
    width: 10px;
    /* scrollbar width */
  }

  .table-responsive::-webkit-scrollbar-track {
    background: var(--panel);
    /* track background */
    border-radius: 12px;
  }

  .table-responsive::-webkit-scrollbar-thumb {
    background: #444b5e;
    /* thumb color */
    border-radius: 12px;
    border: 2px solid var(--panel);
    /* spacing effect */
  }

  .table-responsive::-webkit-scrollbar-thumb:hover {
    background: #5a637a;
    /* hover color */
  }

  /* Firefox */
  .table-responsive {
    scrollbar-width: thin;
    /* "auto" | "thin" */
    scrollbar-color: #444b5e var(--panel);
    /* thumb | track */
  }


</style>

<div class="container my-4">
  <h2 class="fw-bold mb-3">Earnings & Payments</h2>

  <!-- Shell like model -->
  <div class="shell my-4">
    <div class="row g-3">
      <div class="col-md-6">
        <div class="summary-card summary-green">
          <div class="d-flex justify-content-center p-3">
            <div>
              <h4 class="mb-1 text-center" style="font-weight:700">This Week</h4>
              <h5 class="summary-value text-center" style="color:#83ff7a">₹<%= weekEarnings.toFixed(2) %></h5>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="summary-card summary-blue">
          <div class="d-flex  justify-content-center p-3 align-items-start">
            <div>
              <h4 class="mb-1 text-center" style="font-weight:700">This Month</h4>
              <h5 class="summary-value text-center" style="color:#7aa6ff">₹<%= monthEarnings.toFixed(2) %></h5>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment History panel -->
  <div class="table-wrap">
    <div class="p-3" style="border-bottom:1px solid var(--line);">
      <h5 class="fw-bold mb-0">Payment History</h5>
    </div>

    <div class="table-responsive">
      <table>
        <thead>
          <tr>
            <th>Job</th>
                        <th>Customer</th>

            <th>Admin</th>
            <th>Amount</th>
            <th>Method</th>
            <th>Date Paid</th>
          </tr>
        </thead>
        <tbody>
          <% if (payments.length === 0) { %>
            <tr>
              <td colspan="6" style="text-align:center; color: var(--muted);">No payments yet</td>
            </tr>
          <% } else { %>
            <% payments.forEach(pay => { %>
              <tr>
                <td><%= pay.job ? pay.job.serviceType : "N/A" %></td>
                <td>
                  <%= pay.job ? pay.job.customer.name : "N/A" %>
                </td>
                <td><%= pay.admin ? pay.admin.companyName : "N/A" %></td>
                <td>₹<%= pay.amount %></td>
                <td><%= pay.paymentMethod %></td>
                
                <td><%= pay.paidDate ? pay.paidDate.toDateString() : "—" %></td>
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>
